## JVM的内存结构和内存分配
[TOC] 
### 内存模型
java 虚拟机将其管辖的内存大致分三个逻辑部分：`方法取（Method Area）`、`java栈`和`java堆`
1. 方法区是静态分配的，编译器将变量绑定在某个存储位置上，而且这些绑定不会在运行时改变。
常数池，源代码中的命名常量、String 常量和 static 变量保存在方法区。
2. Java Stack 是一个逻辑概念，特点是后进先出。一个栈的空间可能是连续的，也可能是不连续的。
 最典型的 Stack 应用是方法的调用，Java 虚拟机每调用一次方法就创建一个方法帧（frame），退出该
方法则对应的 方法帧被弹出(pop)。栈中存储的数据也是运行时确定的。
3. Java 堆分配(heap allocation)意味着以随意的顺序，在运行时进行存储空间分配和收回的内存管理模型。
 堆中存储的数据常常是大小、数量和生命期在编译时无法确定的。Java 对象的内存总是在 heap 中分配。
我们每天都在写代码，每天都在使用 JVM 的内存。
### 内存分配
1. 基础数据类型直接在栈空间分配;
2. 方法的形式参数，直接在栈空间分配，当方法调用完成后从栈空间回收
3. 引用数据类型，需要用 new 来创建，既在栈空间分配一个地址空间，又在堆空间分配对象的类变量
4. 方法的引用参数，在栈空间分配一个地址空间，并指向堆空间的对象区，当方法调用完后从栈空间回收
5. 局部变量 new 出来时，在栈空间和堆空间中分配空间，当局部变量生命周期结束后，栈空间立刻被回收，堆
空间区域等待 GC 回收
6. 方法调用时传入的实际参数，先在栈空间分配，在方法调用完成后从栈空间释放;
7. 字符串常量在 DATA 区域分配 ，this 在堆空间分配
8. 数组既在栈空间分配数组名称， 又在堆空间分配数组实际的大小！